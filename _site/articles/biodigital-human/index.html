<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>BioDigital Human's Scripting API &#8211; xeoLabs</title>
<meta name="description" content="Did you know that BioDigital Human is a fully scriptable engine?">
<meta name="keywords" content="">
<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/">
<meta name="twitter:title" content="BioDigital Human's Scripting API">
<meta name="twitter:description" content="Did you know that BioDigital Human is a fully scriptable engine?">
<meta name="twitter:creator" content="@xeolabs">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="BioDigital Human's Scripting API">
<meta property="og:description" content="Did you know that BioDigital Human is a fully scriptable engine?">
<meta property="og:url" content="/articles/biodigital-human">
<meta property="og:site_name" content="xeoLabs">





<link rel="canonical" href="/articles/biodigital-human">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="xeoLabs Feed">
<link rel="author" href="https://plus.google.com/u/0/110983138227486752827/posts?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.min.css">

<!--[if (lt IE 9) & (!IEMobile)]>
<link rel="stylesheet" href="/assets/css/ie.min.css">
<![endif]-->

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="article" itemscope itemtype="http://schema.org/WebPage">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="">xeoLabs</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement">
		    <ul>
		        
				<li><a href="/about" >About</a></li>
		        
				<li><a href="/articles" >Articles</a></li>
		        
				<li><a href="http://scenejs.org" target="_blank">SceneJS</a></li>
		        
				<li><a href="http://biodigitalhuman.com" target="_blank">BioDigital Human</a></li>
		        
		        <li><i class="icon-feed"></i> <a href="/feed.xml" title="Atom/RSS feed">Feed</a>
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/Blog">
  <div class="article-author-top">
    <img src="/images/bio-photo.jpg" class="bio-photo" alt="Lindsay Kay bio photo"></a>
<h3>Lindsay Kay</h3>
<p>WebGL developer: SceneJS author, BioDigital Human platform architect</p>
<a href="http://twitter.com/xeolabs" class="author-social" target="_blank"><i class="icon-twitter"></i> Twitter</a>

<a href="https://plus.google.com/u/0/110983138227486752827/posts" class="author-social" target="_blank"><i class="icon-google-plus"></i> Google+</a>
<a href="http://linkedin.com/in/lindsaystanleykay" class="author-social" target="_blank"><i class="icon-linkedin"></i> LinkedIn</a>

<a href="http://github.com/xeolabs" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>


  </div>
  <article itemscope itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
    <div class="headline-wrap">
      <h1 itemprop="name">BioDigital Human's Scripting API</h1>
      <h2></h2>
    </div><!--/ .headline-wrap -->
    <div class="article-wrap" itemprop="text">
      <section id="table-of-contents" class="toc">
  <header>
    <h3>Contents</h3>
  </header>
<div id="drawer">
<ul id="markdown-toc">
  <li><a href="#javascript-api">JavaScript API</a></li>
  <li><a href="#message-api">Message API</a>    <ul>
      <li><a href="#use-case-integration-with-ice-storm">Use case: Integration with ICE STORM</a></li>
    </ul>
  </li>
</ul>

  </div>
</section>
<!-- /#table-of-contents -->

<div style="width:100%; margin:0 auto; text-align: center;"><iframe width="640" height="360" src="//www.youtube.com/embed/2vJ13EXG6rc" frameborder="0"> </iframe></div>

<h1 id="javascript-api">JavaScript API</h1>

<p>Though the Message API is perfect for two programs to talk to one another, it’s somewhat clunky for scripting.
Therefore, we wrapped the message API in an intuitive JavaScript library that asynchronously proxies all of
Human’s functionality behind a bunch of objects using pub/sub and promises. In true game scripting fashion, this
API provides everything you need to write specialized UIs and apps on the Human platform.</p>

<p>First, embed a Human in an IFRAME:</p>

<div class="highlight"><pre><code class="html"><span class="nt">&lt;iframe</span> <span class="na">id=</span><span class="s">&quot;my-iframe&quot;</span> <span class="na">src=</span><span class="s">&quot;..human URL..&quot;</span><span class="nt">&gt;&lt;/iframe&gt;</span>
</code></pre></div>

<p>Link to the API library:</p>

<div class="highlight"><pre><code class="html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;human-api.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div>

<p>Instantiate an API client, connected to the IFRAME:</p>

<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">human</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HumanAPI</span><span class="p">.</span><span class="nx">Human</span><span class="p">({</span>
    <span class="nx">iframe</span><span class="o">:</span><span class="p">{</span> <span class="nx">id</span><span class="o">:</span><span class="s2">&quot;my_iframe&quot;</span> <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>

<p>Then go ahead and start driving that Human. Let’s show the Skeletal and Muscular
systems in X-ray mode, with everything transparent except for the left upper arm and bla. We’ll also
 position the camera:</p>

<div class="highlight"><pre><code class="javascript"><span class="c1">// Show these objects:</span>
<span class="nx">human</span><span class="p">.</span><span class="nx">scene</span><span class="p">.</span><span class="nx">showObjects</span><span class="p">({</span>
   <span class="s2">&quot;maleAdult-Skeletal_System&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
   <span class="s2">&quot;maleAdult-Muscular_System&quot;</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>

<span class="c1">// Selected objects will be opaque in X-Ray mode</span>
<span class="nx">human</span><span class="p">.</span><span class="nx">anatomy</span><span class="p">.</span><span class="nx">selectObjects</span><span class="p">({</span>
   <span class="s2">&quot;maleAdult-Frontal_Bone&quot;</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>

<span class="c1">// Activate X-Ray mode</span>
<span class="nx">human</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">xray</span><span class="p">.</span><span class="nx">setEnabled</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="c1">// Fly the camera to the given position</span>
<span class="nx">human</span><span class="p">.</span><span class="nx">view</span><span class="p">.</span><span class="nx">camera</span><span class="p">.</span><span class="nx">flyTo</span><span class="p">({</span>
    <span class="nx">eye</span><span class="o">:</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="o">-</span><span class="mi">100</span> <span class="p">},</span>
    <span class="nx">look</span><span class="o">:</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="o">-</span><span class="mi">100</span> <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>

<p>All Human state may be subscribed to via the API, including repository content, camera state, modes, scene objects etc.
For example, to subscribe to the objects currently in the 3D scene:</p>

<div class="highlight"><pre><code class="javascript"><span class="nx">human</span><span class="p">.</span><span class="nx">scene</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">,</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">objects</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Called whenever objects are loaded or unloaded</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Scene objects:&quot;</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">objectId</span> <span class="k">in</span> <span class="nx">objects</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">object</span> <span class="o">=</span> <span class="nx">objects</span><span class="p">[</span><span class="nx">objectId</span><span class="p">];</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">object</span><span class="p">.</span><span class="nx">objectId</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="nx">object</span><span class="p">.</span><span class="nx">displayName</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
</code></pre></div>

<h1 id="message-api">Message API</h1>

<p>Human has a JSON-RPC API, which lets us control it with commands via either the Web Socket or
<a href="http://en.wikipedia.org/wiki/Web_Messaging">Web Message</a> protocols:</p>

<div class="highlight"><pre><code class="javascript"><span class="p">{</span>
    <span class="nx">command</span><span class="o">:</span> <span class="s2">&quot;XRay.SetEnabled&quot;</span><span class="p">,</span>
    <span class="nx">enabled</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">},</span>
<span class="p">{</span>
    <span class="nx">command</span><span class="o">:</span> <span class="s2">&quot;Camera.FlyTo&quot;</span><span class="p">,</span>
    <span class="nx">eye</span><span class="o">:</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="o">-</span><span class="mi">100</span> <span class="p">},</span>
    <span class="nx">look</span><span class="o">:</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="mi">3</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="use-case-integration-with-ice-storm">Use case: Integration with ICE STORM</h2>
<p>This was how we networked Human with Lockheed Martin’s ICE STORM simulator at Health 2.0 last year:</p>

<p><img src="/images/icestorm.jpg" alt="Lockheed ICE STORM ICU Simulator" /></p>

<p>As the patient in the Lockheed’s ER simulation on the left experienced changes in their condition, Human on
the right synchronised its animated view of the patient’s respiratory and cardiovascular systems in real time to show
changes in respiration and heart rate, as well as conditions such as atrial and ventricular fibrillation, coronary
congestion and so on.</p>

      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          <img src="/images/bio-photo.jpg" class="bio-photo" alt="Lindsay Kay bio photo"></a>
<h3>Lindsay Kay</h3>
<p>WebGL developer: SceneJS author, BioDigital Human platform architect</p>
<a href="http://twitter.com/xeolabs" class="author-social" target="_blank"><i class="icon-twitter"></i> Twitter</a>

<a href="https://plus.google.com/u/0/110983138227486752827/posts" class="author-social" target="_blank"><i class="icon-google-plus"></i> Google+</a>
<a href="http://linkedin.com/in/lindsaystanleykay" class="author-social" target="_blank"><i class="icon-linkedin"></i> LinkedIn</a>

<a href="http://github.com/xeolabs" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>


        </div>
        <p class="byline"><strong>BioDigital Human's Scripting API</strong> was published on <time datetime="2013-09-27T00:00:00-04:00" itemprop="datePublished">September 27, 2013</time> by <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name"><a href="/about" title="About Lindsay Kay" itemprop="url">Lindsay Kay</a></span></span>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/articles">View all articles</a>)</small></h4>
    <ul>
    
      
      
      
      <li><a href="/articles/code-highlighting-post" title="Syntax Highlighting Post">Syntax Highlighting Post</a></li>
      
    
      
      
      
      <li><a href="/articles/readability-feature-post" title="Post with Large Feature Image and Text">Post with Large Feature Image and Text</a></li>
      
    
      
      
      
      <li><a href="/articles/sample-post-images" title="A Post with Images">A Post with Images</a></li>
      
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    <span>&copy; 2013 Lindsay Kay. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>


</body>
</html>
